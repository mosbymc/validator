var validator=function(d){function z(b){b&&b.constructor===Array&&d.each(b,function(a,b){try{d(document).on(b,"input",function(a){var e=d(a.currentTarget);if((e.hasClass("inputValidate")||e.parents(".inputValidate:first")&&0<e.parents(".inputValidate:first").length)&&(e.data("validateon")===b||"input"===b&&void 0==e.data("validateon"))&&(void 0==e.parents(".inputValidate:first").data("excludeinputs")||-1===e.parents(".inputValidate:first").data("excludeinputs").indexOf(a.currentTarget.id))){a=v(e,
a);d(a.input).removeData("validationdone").removeAttr("validationdone");var h=[];h.push(A(d(e)));B(a,h);w(h,a)}})}catch(e){console.log("Could not bind forms to event: '"+b+"'\n"+e)}})}function C(b,a){if(!1!==a.callBefore){var c=[window].concat(a.callBefore.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]});if("function"===typeof c)try{c.call(this,b,Object.freeze(a),r)}catch(e){console.log("'Call before' function: '"+a.callBefore+"'' failed to execute\n"+e),r(!0,b,a)}else console.log("The supplied 'call before' function: "+
a.callBefore+" could not be found."),r(!0,b,a)}else r(!0,b,a)}function r(b,a,c){d(c.form).removeData("validationdone").removeAttr("validationdone");if(b){null!==c.groupErrors&&(d("#"+c.groupErrors).find(".errorSpan").remove(),d("#"+c.groupErrors).find("br").remove());b=d(a).find("input, select");a=[];for(var e=0,g=b.length;e<g;e++){var f=A(d(b[e]));null===f?!1:a=a.concat(f)}B(c,a);w(a,c)}}function A(b){var a=b.data("validationrules")||"",c=b.data("customrules")||"",e=[],d=[];""===b.data("required")?
e.push({method:"required",type:"required"}):!1;b.data("min")?e.push({method:"testMinValue",type:"validator"}):!1;b.data("max")?e.push({method:"testMaxValue",type:"validator"}):!1;b.data("matchfield")?e.push({method:"verifyMatch",type:"validator"}):!1;b.data("maxchecked")?e.push({method:"maxChecked",type:"validator"}):!1;b.data("minchecked")?e.push({method:"minChecked",type:"validator"}):!1;for(var a=a.split(","),f=0,h=a.length;f<h;f++)""!==a[f]&&e.push({method:a[f],type:"validator"});a=c.split(",");
c=0;for(f=a.length;c<f;c++)""!==a[c]&&e.push({method:a[c],type:"custom"});c=0;for(f=e.length;c<f;c++)d.push({methodInfo:e[c],valid:"waiting"});return 0<e.length?{element:b,rules:d}:null}function B(b,a){for(var c=0,e=a.length;c<e;c++){var d=a[c].element,f=!1,h=performance.now().toString().split(".");G(d);p(d).removeClass("invalid");d.data("vts",b.time).data("vid",h[1]);for(var h=a[c].rules,k=0,m=h.length;k<m;k++)if("required"===h[k].methodInfo.type)tested="radio"===d[0].type||"checkbox"===d[0].type?
l.requiredGroup(d):l.requiredInput(d),x(tested,d,b,"required",a),tested.valid||(f=!0);else if(f)y(d,a,h[k].methodInfo.method,null);else{var q=h[k].methodInfo.method,n="validator"===h[k].methodInfo.type?l[q]:[window].concat(q.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]});if("function"===typeof n){var D={option:b,element:d,rule:q,inputArray:a};Object.freeze(D);tested=n.call(this,d,D,E);"validator"===h[k].methodInfo.type?x(tested,d,b,q,a):!1}else console.log("Could not find library function: "+
q+" for element: "+d),y(d,a,q,null)}}}function x(b,a,c,e,g){if(!b.valid){var f=F(a);H(a,b,c,e,f.width,f.height);I(c,a,e);if(c.group){if(0===d("#"+a.data("vid")+"InputGrp").length)switch(c=p(a),!1===a.hasClass("groupByInput")?a.parents(".formValidate:first").data("location"):a.data("location")){case "right":c.after("<div id='"+a.data("vid")+"InputGrp' data-parentinput='"+a.data("vid")+"' class='hInputGroup alignInput'></div>");break;case "left":c.before("<div id='"+a.data("vid")+"InputGrp' data-parentinput='"+
a.data("vid")+"' class='hInputGroup alignInput'></div>");break;case "top":c.before("<div id='"+a.data("vid")+"InputGrp' data-parentinput='"+a.data("vid")+"' class='vInputGroup'></div>");break;case "bottom":c.after("<div id='"+a.data("vid")+"InputGrp' data-parentinput='"+a.data("vid")+"' class='vInputGroup'></div>")}c=d("#"+a.data("vid")+"error"+e);f="<span class='inputGrpErrorSpan'>"+c.html()+"</span></br>";d("#"+a.data("vid")+"InputGrp").append(f);c.remove()}}y(a,g,e,b.valid)}function y(b,a,c,d){for(var g=
0,f=a.length;g<f;g++)if(b[0]===a[g].element[0])for(var h=0,k=a[g].rules.length;h<k;h++)if(c===a[g].rules[h].methodInfo.method){a[g].rules[h].valid=d;break}}function E(b,a){try{a.element.data("vts")===a.option.time&&x(b,a.element,a.option,a.rule,a.inputArray),w(a.inputArray,a.option)}catch(c){console.log("Returned parameters from custom validation rule: '"+a.rule+"', are not in the correct format.\n"+c),a.option.button.prop("disabled",!1)}}function w(b,a){var c=void 0===a.form?d(a.input):d(a.form);
if(void 0===c.data("validationdone")||!c.data("validationdone")){for(var e=0,g=0,f=0,h=b.length;f<h;f++)for(var k=0,l=b[f].rules.length;k<l;k++){if("waiting"===b[f].rules[k].valid)return;!1===b[f].rules[k].valid?(e++,g++):!0===b[f].rules[k].valid&&g++}c.data("validationdone",!0);a.groupErrors&&a.form.hasClass("highlightErrors")&&d.each(b,function(a,b){d.each(b.rules,function(a,c){!1===c.valid&&(d(b.element).on("focus",function(){d("[id='formGrp"+b.element.data("vid")+c.methodInfo.method+"']").addClass("groupHighlight")}),
d(b.element).on("blur",function(){d("[id='formGrp"+b.element.data("vid")+c.methodInfo.method+"']").removeClass("groupHighlight")}))})});void 0!==a.button&&a.button.prop("disabled",!1);d(document).trigger("validated",[{type:void 0===a.form?"input validation":"form validation",element:void 0!==a.form?a.form[0].id:a.input,passed:0===e,count:e,totalRules:b.length,testedRules:g,time:a.time,event:a.event}]);if(0===e&&null!==a.success)if(c=[window].concat(a.success.split(".")).reduce(function(a,b){return"function"===
typeof a?a()[b]:a[b]}),"function"===typeof c)try{c.call(this)}catch(m){console.log("'Success' function: '"+a.success+"'' failed to execute\n"+m)}else console.log("Could not find successful validation function: '"+a.success+"' for the current form.");else 0===e&&null!==a.event&&null!==a.event.currentTarget&&void 0===a.input?(a.event.preventDefault(),a.form[0].submit()):0!==e&&null!==a.event&&null!==a.event.currentTarget&&a.event.preventDefault()}}function I(b,a,c){if(void 0!==b.groupErrors&&null!==
b.groupErrors){d("#"+a.data("vid")+"error"+c).each(function(e,f){var h=d(a).data("errorprefix");void 0!==h&&d(f).html(h+": "+d(f).html());h="<span class='errorSpan' id='formGrp"+a.data("vid")+c+"' data-parentinput='"+a.data("vid")+"'>"+d(f).html()+"</span>";J(b,a.data("vid"),h,c);d(f).remove()});var e=d("#"+b.groupErrors);e.hasClass("showGroupedErrors")||e.removeClass("hideGroupedErrors").addClass("showGroupedErrors")}}function J(b,a,c,e){var g=d("#"+b.groupErrors).children(".errorSpan"),f=!1;if(void 0!==
g&&0<g.length){if(g.each(function(b,g){if(d(g).data("parentinput")===a)return d(c).insertBefore(d(g)),d("</br>").insertAfter(d("#formGrp"+a+e)),f=!0,!1}),!f){var g=b.form.find("input"),h=d("#"+a),h=g.index(h);if(h<g.length-1){for(h+=1;h<g.length;h++){var k=d("#"+b.groupErrors).children("[data-parentinput='"+g[h].id+"']");if(0<k.length){d(c).insertBefore(k);d("</br>").insertAfter(d("#formGrp"+a+e));f=!0;break}}f||d("#"+b.groupErrors).append(c).append("</br>")}}}else d("#"+b.groupErrors).append(c).append("</br>")}
function H(b,a,c,e,g,f){K(b,a,c,e,g,f);var h=d("#"+b.data("vid")+"error"+e);0<b.prevUntil("input").filter(".helptext:first").length&&b.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");c.display?L(c,b,h,g,f):c.display||null!==c.modalId?c.display||null===c.modalId||M(c.modalId,b,g,f,h):d(window).scroll(function(){n(b,g,f,h)})}function K(b,a,c,e,g,f){var h=p(b);h.addClass("invalid");e=b.data("vid")+"error"+e;1>d("#"+e).length&&(h.parent().append("<div id='"+
e+"' data-parentinput='"+b.data("vid")+"'></div>"),h=d("#"+e),h.addClass("errorMessage"),h.html(void 0===a.message?"Validation Error":a.message).css("width",void 0===a.width?"":a.width),n(b,g,f,h),c.display?h.addClass("hideMessage").removeClass("showMessage"):h.addClass("showMessage").removeClass("hideMessage"))}function u(b,a,c,e,g){var f,h,k=void 0===a.data("location")?"right":a.data("location");f=parseInt(a.data("offsetwidth"))||0;h=parseInt(a.data("offsetheight"))||0;switch(k){case "right":return[b.left+
p(a).width()+c+f+8-d(window).scrollLeft(),b.top-d(window).scrollTop()-h];case "left":return[b.left-g.width()-c-f-8-d(window).scrollLeft(),b.top-d(window).scrollTop()-h];case "top":return[b.left+f-d(window).scrollLeft(),b.top-d(window).scrollTop()-5-g.height()-e-h];case "bottom":return[b.left+f-d(window).scrollLeft(),b.top-d(window).scrollTop()+p(a)[0].clientHeight+8+e+h]}}function G(b){d("[id^='"+b.data("vid")+"']").each(function(a,b){d(b).remove()})}function n(b,a,c,d){b=u(p(b).offset(),b,a,c,d);
d.addClass("showMessage").removeClass("hideMessage").css("top",b[1]).css("left",b[0])}function L(b,a,c,d,g){var f=p(a);f.bind("mouseover",function(){null!==b.modalId?t(b.modalId,a,d,g,c)&&n(a,d,g,c):n(a,d,g,c)});f.bind("mouseout",function(){c.addClass("hideMessage").removeClass("showMessage")})}function t(b,a,c,e,g){a=u(p(a).offset(),a,c,e,g);e=d("#"+b);var f=e.offset();b=f.top-d(window).scrollTop();c=b+e.height();f=f.left-d(window).scrollLeft();e=f+e.width();return b>a[1]||c<a[1]||f>a[0]||e<a[0]+
g.width()?!1:!0}function M(b,a,c,e,g){t(b,a,c,e,g)||g.addClass("hideMessage").removeClass("showMessage");d("#"+options.modalId).on("scroll",function(){t(b,a,c,e,g)?(n(a,c,e,g),g.removeClass("hideMessage").addClass("showMessage")):g.addClass("hideMessage").removeClass("showMessage")});d(window).scroll(function(){t(b,a,c,e,g)?(n(a,c,e,g),g.removeClass("hideMessage").addClass("showMessage")):g.addClass("hideMessage").removeClass("showMessage")})}function F(b){var a=0,c=0;d("[id^='"+b.data("vid")+"error']").each(function(b,
g){a+=d(g).width()+5;c+=d(g).height()+5});return{width:a,height:c}}function p(b){var a=void 0===b.data("displayon")?null:b.data("displayon"),c,e;if(null!==a){c=a.split(",");a=c[0];e=c[1];if(1===d(a).length)return d(a);var g="up"===c[1]?":last":":first";if(0===("up"===e?b.prevAll(a+":first"):b.nextAll(a+":first")).length)for(c=b.parent();0!==c.length;){if(c.hasClass(a.substring(1,a.length)))return c;for(var f="up"===e?c.prev():c.next();0!==f.length;){if(f.hasClass(a.substring(1,a.length)))return f;
var h=f.find(a+g);if(0!==h.length)return h;f="up"===e?f.prev():f.next()}c=c.parent()}else return"up"===c[1]?b.prevAll(a+":first"):b.nextAll(a+":first")}return b}function N(b,a){var c=b.prevUntil("input").filter(".helptext:first"),e=p(b).offset(),g=F(b);c.addClass("showMessage").removeClass("hideMessage");var f=u(e,b,0,0,c);c.css("top",f[1]).css("left",f[0]);b.data("htid",(new Date).getTime());null!==a&&(d(document).on("helpTextModalScroll"+b.data("htid"),function(){var d=g.width,e=g.height;!t(a,b,
d,e,c)||b.hasClass("invalid")?c.addClass("hideMessage").removeClass("showMessage"):(c.addClass("showMessage").removeClass("hideMessage"),n(b,d,e,c))}),d("#"+a).on("scroll",function(){d(document).trigger("helpTextModalScroll"+b.data("htid"),[{}])}));d(document).on("helpTextScroll"+b.data("htid"),function(){var a=u(e,b,g.width,g.height,c);c.css("top",a[1]).css("left",a[0])});d(window).on("scroll",function(){d(document).trigger("helpTextScroll"+b.data("htid"),[{}])})}function O(b,a,c){testedArray=[];
d.each(a.split(","),function(a,d){var e=m[d];if("function"===typeof e)try{testedArray.push(e.call(this,b,c))}catch(k){console.log("The supplied character restriction type: '"+d+"' could not be executed.\n"+k)}else console.log("The supplied character restriction type: '"+d+"' is not an acceptable type.")});if(0<testedArray.length){a=0;for(var e=testedArray.length;a<e;a++)if(!testedArray[a]){c.preventDefault();break}}}function v(b,a){options={display:b.hasClass("hover"),success:b.data("formaction")||
b.data("inputaction")||null,modalId:b.data("modalid")||null,group:!1===b.hasClass("groupByInput")?b.parents(".formValidate:first").hasClass("groupByInput"):b.hasClass("groupByInput"),time:(new Date).getTime(),event:a};"INPUT"===b[0].tagName?options.input=b:options.form=b;return options}d(document).on("click","input, button",function(b){var a=d(b.currentTarget),c=a.parents(".formValidate:first");0<c.length&&a.hasClass("validate")&&(b=v(c,b),b.groupErrors=c.data("grouperrors")||null,b.callBefore=c.data("beforevalidate")||
!1,b.button=a,a.prop("disabled",!0),C(c,b))});d(document).on("keypress","input",function(b){var a=d(b.currentTarget);void 0!=a.data("inputtype")&&O(a,a.data("inputtype"),b)});d(document).on("focus","input",function(b){var a=d(b.currentTarget);if(!a.hasClass("invalid")&&0<a.prevUntil("input").filter(".helptext:first").length&&1>d("[id^='"+a[0].id+"error']").length&&1>d("#"+a[0].id+"InputGrp").length){var c=a.parents(".formValidate:first").data("modalId")||a.parents(".inputValidate:first").data("modalId")||
a.data("modalid")||null;N(a,c);a.one("blur",function(b){a.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");null!==c&&d(document).off("helpTextModalScroll"+a.data("htid"));d(document).off("helpTextScroll"+a.data("htid"))})}});z(["input"]);var m={inputTypeTester:function(b,a){for(var c=a.charCode?a.charCode:a.keyCode,e=0,g=b.length;e<g;e++)if(d.isArray(b[e])){if(c>b[e][0]&&c<b[e][1])return!0}else if(c===b[e])return!0;return!1},numeric:function(b,a){return m.inputTypeTester([8,
[43,47],[47,58]],a)},integer:function(b,a){return m.inputTypeTester([8,45,[47,58]],a)},positiveInt:function(b,a){return m.inputTypeTester([8,[47,58]],a)},nonNumeric:function(b,a){return m.inputTypeTester([[-1,48],[57,128]],a)},alphaNumeric:function(b,a){return m.inputTypeTester([8,[47,58],[64,91],[96,123]],a)},nonAlphaNumeric:function(b,a){return m.inputTypeTester([[-1,48],[57,65],[90,97],[122,128]],a)},printable:function(b,a){return m.inputTypeTester([8,[31,128]],a)},printableNonNumeric:function(b,
a){return m.inputTypeTester([8,[31,48],[57,128]],a)},phone:function(b,a){return m.inputTypeTester([8,32,40,41,45,46,[47,58]],a)},shortDate:function(b,a){return m.inputTypeTester([8,[44,58]],a)},longDate:function(b,a){return m.inputTypeTester([8,32,44,46,[47,58],[64,91],[96,123]],a)}},l={requiredInput:function(b){var a=/^\s*$/.test(b.val());return 1>b.val().length||a||""===b.val()?{valid:!1,message:"Required field.",width:100}:{valid:!0}},requiredGroup:function(b){return b.attr("name")?(b=b.attr("name"),
void 0===d("input[name="+b+"]:checked").val()?{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):b.data("checkboxgroup")?(b=b.data("checkboxgroup"),1>d("input[data-checkboxgroup="+b+"]:checked").length?{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):{valid:!1,message:"This input has no identifying name."}},testMinValue:function(b){var a=b.data("min");return parseInt(a)>parseInt(b.val())?{valid:!1,message:"Minimum allowed value: "+a,width:175}:parseInt(b.val())?
{valid:!0}:{valid:!1,message:"The value entered is not a number.",width:200}},testMaxValue:function(b){var a=b.data("max");return parseInt(a)<parseInt(b.val())?{valid:!1,message:"Maximum allowed value: "+a,width:175}:parseInt(b.val())?{valid:!0}:{valid:!1,message:"The value entered is not a number.",width:200}},maxChecked:function(b){var a=b.data("maxchecked");return b.data("checkboxgroup")&&(b=b.data("checkboxgroup"),d("input[data-checkboxgroup="+b+"]:checked").length>a)?{valid:!1,message:"You cannot select more than "+
a+" option(s).",width:250}:{valid:!0}},minChecked:function(b){var a=b.data("minchecked");return b.data("checkboxgroup")&&(b=b.data("checkboxgroup"),d("input[data-checkboxgroup="+b+"]:checked").length<a)?{valid:!1,message:"You must select at least "+a+" option(s).",width:250}:{valid:!0}},verifyMatch:function(b){var a=d("#"+b.data("matchfield"));return b.val()===a.val()?{valid:!0}:{valid:!1,message:"Passwords must match.",width:200}},email:function(b){return l.regexTester(b,/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[A-Za-z]{2,4}$/,
"Not a valid email format.",200)},name:function(b){return l.regexTester(b,/^([a-zA-z\s]{4,32})$/,"Not a valid name.",200)},ssn:function(b){return l.regexTester(b,/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/,"Not a valid social security number.",200)},uscurrency:function(b){return l.regexTester(b,/^(\$|)([1-9]\d{0,2}(\,\d{3})*|([1-9]\d*))(\.\d{2})?$/,"Not a valid amount.",200)},phone:function(b){return l.regexTester(b,/^\D?(\d{3})\D?\D?(\d{3})\D?(\d{4})$/,"Not a valid phone number.",
200)},address:function(b){return l.regexTester(b,/^\d+\s?\w+\s?\w+\s?\w+$/,"Not a street address.",200)},numeric:function(b){return l.regexTester(b,/\/[0-9]|\.\//,"Only digits are allowed.",200)},zip:function(b){return l.regexTester(b,/^\d{5}$/,"Not a valid zip code.",200)},date:function(b){return l.regexTester(b,/^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/,
"Not a valid date.",200)},url:function(b){return l.regexTester(b,/^(http|https|ftp)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?\/?([a-zA-Z0-9\-\._\?\,\'/\\+&amp;%\$#\=~])*$/,"Not a valid url.",200)},password:function(b){return l.regexTester(b,/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,40}$/,"Password must be at least 8 characters and include both upper and lower case letters and a number.",300)},regexTester:function(b,a,c,d){a=a.test(b.val());return""===b.val()||a?{valid:!0}:{valid:a,message:c,
width:d}}};return{setAdditionalEvents:z,validate:function(b){if(void 0!==b){var a;"string"===typeof b?a=d(b):"object"===typeof b&&(a=b);try{var c=a.find(".validate"),e=v(a,null);e.groupErrors=a.data("grouperrors")||null;e.callBefore=a.data("beforevalidate")||!1;e.button=c;c.prop("disabled",!0);C(a,e)}catch(g){console.log("Could not validate form: "+b+"\n"+g)}}else console.log("Cannot validate a null form.")},validateForm:r,customRulesCallback:E,removeErrors:function(b){var a;void 0!==b?"string"===
typeof b?a=d(b):"object"===typeof b&&(a=b):a=d("body");try{a.find("input").each(function(a,b){d("[id^='"+d(b).data("vid")+"error']").remove();d("[id^='"+d(b).data("vid")+"InputGrp']").remove()}),d("[id^='"+a.data("vid")+"']").each(function(a,b){b.remove()}),a.find(".errorMessage").each(function(a,b){b.remove()}),a.find(".invalid").each(function(a,b){d(b).removeClass("invalid")}),a.find(".showGroupedErrors").each(function(a,b){d(b).empty().removeClass("showGroupedErrors").addClass("hideGroupedErrors")})}catch(c){console.log("Could not remove errors from the supplied element: "+
b+"\n"+c)}}}}(jQuery);
