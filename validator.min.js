var validator=function(d){function y(a){a&&a.constructor===Array&&d.each(a,function(a,c){d(document).on(c,"input",function(a){var b=d(a.currentTarget),f=b.parents(".inputValidate:first");!(b.hasClass("inputValidate")||f&&0<f.length)||b.data("validateon")!==c&&("input"!==c||void 0!=b.data("validateon"))||f.data("excludeinputs")&&-1!==f.data("excludeinputs").indexOf(a.currentTarget.id)||(a=v(b,a),f=[],f.push(z(d(b))),null===f[0]&&1===f.length)||(k[a.time]={options:a,inputArray:f},A(a,f),w(b))})})}function B(a,
b){a.data("vts",b.time);b.button.prop("disabled",!0);if(!1!==b.callBefore){var c=[window].concat(b.callBefore.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]});"function"===typeof c?c.call(a,t):t(!0,a,b)}else t(!0,a,b)}function t(a,b){var c=k[b.data("vts")].options;if(a){null!==c.groupErrors&&(d("#"+c.groupErrors).find(".errorSpan").remove(),d("#"+c.groupErrors).find("br").remove());for(var g=d(b).find("input, select"),e=[],f=0,h=g.length;f<h;f++){var m=z(d(g[f]));null!==
m&&(e=e.concat(m))}k[b.data("vts")].inputArray=e;A(c,e);w(b)}}function z(a){var b=a.data("validationrules")||"",c=a.data("customrules")||"",d={};""===a.data("required")&&(d.required="waiting");a.data("min")&&(d["validator.validationRules.testMinValue"]="waiting");a.data("max")&&(d["validator.validationRules.testMaxValue"]="waiting");a.data("matchfield")&&(d["validator.validationRules.verifyMatch"]="waiting");a.data("maxchecked")&&(d["validator.validationRules.maxChecked"]="waiting");a.data("minchecked")&&
(d["validator.validationRules.minChecked"]="waiting");for(var b=b.replace(/ /g,"").split(","),e=0;e<b.length;e++)""!==b[e]&&(d["validator.validationRules."+b[e]]="waiting");b=c.replace(/ /g,"").split(",");for(e=0;e<b.length;e++)""!==b[e]&&(d[b[e]]="waiting");return 0<Object.keys(d).length?{element:a,rules:d}:null}function A(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c].element,f=!1,h=performance.now().toString().split(".");E(e);n(e).removeClass("invalid");e.data("vts",a.time).data("vid",h[1]).attr("vts",
a.time);var h=b[c].rules,m;for(m in h)"required"===m?(tested="radio"===e[0].type||"checkbox"===e[0].type?l.requiredGroup(e):l.requiredInput(e),C(tested,e,a,m),tested.valid||(f=!0)):f?x(e,m,null):(h=[window].concat(m.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]}),"function"===typeof h?F(m,a.time,h,e):x(e,m,null))}}function F(a,b,c,d){var e=G(a,b,c,d,function(a,b,c){e.done.call(e,{valid:a,message:b,width:c})});e.customFunction.call(d[0],e.validate)}function C(a,b,c,g){if(!a.valid){var e=
D(b);H(b,a,c,g,e.width,e.height);if(c.group){if(0===d("#"+b.data("vid")+"InputGrp").length)a:switch(c=n(b),!1===b.hasClass("groupByInput")?b.parents(".formValidate:first").data("location")||"right":b.data("location")||"right"){case "right":c.after("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='hInputGroup alignInput'></div>");break a;case "left":c.before("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='hInputGroup alignInput'></div>");
break a;case "top":c.before("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='vInputGroup'></div>");break a;case "bottom":c.after("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='vInputGroup'></div>")}c=d("#"+b.data("vid")+"error"+g);e="<span class='inputGrpErrorSpan'>"+c.html()+"</span></br>";d("#"+b.data("vid")+"InputGrp").append(e);c.remove()}else void 0!==c.groupErrors&&null!==c.groupErrors&&I(c,b,g)}x(b,g,a.valid)}function x(a,b,
c){for(var d=a.data("vts"),e,f=0,h=k[d].inputArray.length;f<h;f++)if(e=k[d].inputArray[f],a.data("vid")===e.element.data("vid")){e.rules[b]=c;break}}function J(a){try{d(this.element).data("vts")===this.timeStamp?(C(a,this.element,k[this.timeStamp].options,this.functionName),w(this.element)):delete k[this.timeStamp]}catch(b){k[this.timeStamp].options.button&&k[this.timeStamp].options.button.prop("disabled",!1)}}function w(a){var b=a.data("vts");if(k[b]){k[b].options.form||d(k[b].options.input);a=0;
for(var c=k[b].inputArray,b=k[b].options,g=0,e=c.length;g<e;g++)for(var f in c[g].rules){if("waiting"===c[g].rules[f])return;!1===c[g].rules[f]&&a++}delete k[b.time];b.button&&b.button.prop("disabled",!1);b.groupErrors&&b.form.hasClass("highlightErrors")&&d.each(c,function(a,b){d.each(b.rules,function(a,c){!1===c&&(d(b.element).on("focus",function(){d("[id='formGrp"+b.element.data("vid")+a+"']").addClass("groupHighlight")}),d(b.element).on("blur",function(){d("[id='formGrp"+b.element.data("vid")+
a+"']").removeClass("groupHighlight")}))})});d(document).trigger("validated",[{type:void 0===b.form?"input validation":"form validation",element:void 0!==b.form?b.form[0].id:b.input,succeeded:0===a,event:b.event}]);0===a&&null!==b.success?(f=[window].concat(b.success.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]}),"function"===typeof f&&f.call(b.form?b.form[0]:b.input[0])):0===a&&null!==b.event&&null!==b.event.currentTarget&&void 0===b.input?(b.event.preventDefault(),b.form[0].submit()):
0!==a&&null!==b.event&&null!==b.event.currentTarget&&b.event.preventDefault()}}function I(a,b,c){d("#"+b.data("vid")+"error"+c).each(function(e,f){var g=d(b).data("errorprefix");void 0!==g&&d(f).html(g+": "+d(f).html());g="<span class='errorSpan' id='formGrp"+b.data("vid")+c+"' data-parentinput='"+b.data("vid")+"'>"+d(f).html()+"</span>";K(a,b.data("vid"),g,c);d(f).remove()});var g=d("#"+a.groupErrors);g.hasClass("showGroupedErrors")||g.removeClass("hideGroupedErrors").addClass("showGroupedErrors")}
function K(a,b,c,g){var e=d("#"+a.groupErrors).find("[id^='formGrp"+b+"']");if(0<e.length)d(c).insertBefore(e[0]),d("</br>").insertAfter(d("#formGrp"+b+g));else{var e=a.form.find("input"),f=e.filter(function(){return d(this).data("vid")===b?d(this):!1}),f=e.index(f);if(f<e.length-1)for(f+=1;f<e.length;f++){var h=d("#"+a.groupErrors).children("[data-parentinput='"+d(e[f]).data("vid")+"']");if(0<h.length){d(c).insertBefore(h);d("</br>").insertAfter(d("#formGrp"+b+g));return}}d("#"+a.groupErrors).append(c).append("</br>")}}
function H(a,b,c,g,e,f){L(a,b,c,g,e,f);var h=d("#"+a.data("vid")+"error"+g);0<a.prevUntil("input").filter(".helptext:first").length&&a.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");c.display?M(c,a,h,e,f):c.display||null!==c.modalId?c.display||null===c.modalId||N(c.modalId,a,e,f,h):d(window).scroll(function(){q(a,e,f,h)})}function L(a,b,c,g,e,f){var h=n(a);h.addClass("invalid");g=a.data("vid")+"error"+g;1>d("#"+g).length&&(h.parent().append("<div id='"+
g+"' data-parentinput='"+a.data("vid")+"'></div>"),h=d("#"+g),h.addClass("errorMessage"),h.html(void 0===b.message?"Validation Error":b.message).css("width",void 0===b.width?"":b.width),q(a,e,f,h),c.display?h.addClass("hideMessage").removeClass("showMessage"):h.addClass("showMessage").removeClass("hideMessage"))}function u(a,b,c,g,e){var f,h,k=void 0===b.data("location")?"right":b.data("location");f=parseInt(b.data("offsetwidth"))||0;h=parseInt(b.data("offsetheight"))||0;switch(k){case "right":return[a.left+
n(b).width()+c+f+8-d(window).scrollLeft(),a.top-d(window).scrollTop()-h];case "left":return[a.left-e.width()-c-f-8-d(window).scrollLeft(),a.top-d(window).scrollTop()-h];case "top":return[a.left+f-d(window).scrollLeft(),a.top-d(window).scrollTop()-5-e.height()-g-h];case "bottom":return[a.left+f-d(window).scrollLeft(),a.top-d(window).scrollTop()+n(b)[0].clientHeight+8+g+h]}}function E(a){d("[id^='"+a.data("vid")+"']").each(function(a,c){d(c).remove()})}function q(a,b,c,d){a=u(n(a).offset(),a,b,c,d);
d.addClass("showMessage").removeClass("hideMessage").css("top",a[1]).css("left",a[0])}function M(a,b,c,d,e){var f=n(b);f.bind("mouseover",function(){null!==a.modalId?r(a.modalId,b,d,e,c)&&q(b,d,e,c):q(b,d,e,c)});f.bind("mouseout",function(){c.addClass("hideMessage").removeClass("showMessage")})}function r(a,b,c,g,e){b=u(n(b).offset(),b,c,g,e);g=d("#"+a);var f=g.offset();a=f.top-d(window).scrollTop();c=a+g.height();f=f.left-d(window).scrollLeft();g=f+g.width();return a>b[1]||c<b[1]||f>b[0]||g<b[0]+
e.width()?!1:!0}function N(a,b,c,g,e){r(a,b,c,g,e)||e.addClass("hideMessage").removeClass("showMessage");d("#"+a).on("scroll",function(){r(a,b,c,g,e)?(q(b,c,g,e),e.removeClass("hideMessage").addClass("showMessage")):e.addClass("hideMessage").removeClass("showMessage")});d(window).scroll(function(){r(a,b,c,g,e)?(q(b,c,g,e),e.removeClass("hideMessage").addClass("showMessage")):e.addClass("hideMessage").removeClass("showMessage")})}function D(a){var b=0,c=0;d("[id^='"+a.data("vid")+"error']").each(function(a,
e){b+=d(e).width()+5;c+=d(e).height()+5});return{width:b,height:c}}function n(a){var b=void 0===a.data("displayon")?null:a.data("displayon"),c,g;if(null!==b){c=b.split(",");b=c[0];g=c[1];if(1===d(b).length)return d(b);var e="up"===c[1]?":last":":first";if(0===("up"===g?a.prevAll(b+":first"):a.nextAll(b+":first")).length)for(c=a.parent();0!==c.length;){if(c.hasClass(b.substring(1,b.length)))return c;for(var f="up"===g?c.prev():c.next();0!==f.length;){if(f.hasClass(b.substring(1,b.length)))return f;
var h=f.find(b+e);if(0!==h.length)return h;f="up"===g?f.prev():f.next()}c=c.parent()}else return"up"===c[1]?a.prevAll(b+":first"):a.nextAll(b+":first")}return a}function O(a,b){var c=a.prevUntil("input").filter(".helptext:first"),g=n(a).offset(),e=D(a);c.addClass("showMessage").removeClass("hideMessage");var f=u(g,a,0,0,c);c.css("top",f[1]).css("left",f[0]);a.data("htid",(new Date).getTime());null!==b&&(d(document).on("helpTextModalScroll"+a.data("htid"),function(){var d=e.width,f=e.height;!r(b,a,
d,f,c)||a.hasClass("invalid")?c.addClass("hideMessage").removeClass("showMessage"):(c.addClass("showMessage").removeClass("hideMessage"),q(a,d,f,c))}),d("#"+b).on("scroll",function(){d(document).trigger("helpTextModalScroll"+a.data("htid"),[{}])}));d(document).on("helpTextScroll"+a.data("htid"),function(){var b=u(g,a,e.width,e.height,c);c.css("top",b[1]).css("left",b[0])});d(window).on("scroll",function(){d(document).trigger("helpTextScroll"+a.data("htid"),[{}])})}function P(a,b,c){d.each(b.split(","),
function(b,d){var f=p[d];if("function"===typeof f&&!f.call(a,c))return c.preventDefault(),!1})}function v(a,b){var c={display:a.hasClass("hover"),success:a.data("formaction")||a.data("inputaction")||null,modalId:a.data("modalid")||null,group:!1===a.hasClass("groupByInput")?a.parents(".formValidate:first").hasClass("groupByInput"):a.hasClass("groupByInput"),time:(new Date).getTime(),event:b};"INPUT"===a[0].tagName?c.input=a:(c.form=a,c.groupErrors=a.data("grouperrors")||null,c.callBefore=a.data("beforevalidate")||
!1,c.button=a.find(".validate")||b.currentTarget);return c}function G(a,b,c,d,e){return{done:J,customFunction:c,functionName:a,element:d,validate:e,timeStamp:b}}var k={};d(document).on("click","input, button",function(a){var b=d(a.currentTarget),c=b.parents(".formValidate:first");0<c.length&&b.hasClass("validate")&&(a=v(c,a),k[a.time]={options:a},B(c,a))});d(document).on("keypress","input",function(a){var b=d(a.currentTarget);void 0!=b.data("inputtype")&&P(b,b.data("inputtype"),a)});d(document).on("focus",
"input",function(a){var b=d(a.currentTarget);if(!b.hasClass("invalid")&&0<b.prevUntil("input").filter(".helptext:first").length&&1>d("[id^='"+b.data("vid")+"error']").length&&1>d("#"+b[0].id+"InputGrp").length){var c=b.parents(".formValidate:first").data("modalId")||b.parents(".inputValidate:first").data("modalId")||b.data("modalId")||null;O(b,c);b.one("blur",function(a){b.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");null!==c&&d(document).off("helpTextModalScroll"+
b.data("htid"));d(document).off("helpTextScroll"+b.data("htid"))})}});y(["input"]);var p={inputTypeTester:function(a,b){for(var c=b.charCode?b.charCode:b.keyCode,g=0,e=a.length;g<e;g++)if(d.isArray(a[g])){if(c>a[g][0]&&c<a[g][1])return!0}else if(c===a[g])return!0;return!1},numeric:function(a){return p.inputTypeTester([8,[43,47],[47,58]],a)},integer:function(a){return p.inputTypeTester([8,45,[47,58]],a)},positiveInt:function(a){return p.inputTypeTester([8,[47,58]],a)},nonNumeric:function(a){return p.inputTypeTester([[-1,
48],[57,128]],a)},alphaNumeric:function(a){return p.inputTypeTester([8,[47,58],[64,91],[96,123]],a)},nonAlphaNumeric:function(a){return p.inputTypeTester([[-1,48],[57,65],[90,97],[122,128]],a)},shortDate:function(a){return p.inputTypeTester([8,[44,58]],a)},longDate:function(a){return p.inputTypeTester([8,32,44,46,[47,58],[64,91],[96,123]],a)}},l={requiredInput:function(a){var b=/^\s*$/.test(a.val());return 1>a.val().length||b||""===a.val()?{valid:!1,message:"Required field.",width:100}:{valid:!0}},
requiredGroup:function(a){return a.attr("name")?(a=a.attr("name"),void 0===d("input[name="+a+"]:checked").val()?{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):a.data("checkboxgroup")?(a=a.data("checkboxgroup"),1>d("input[data-checkboxgroup="+a+"]:checked").length?{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):{valid:!1,message:"This input has no identifying name."}},testMinValue:function(a){var b=d(this).data("min");parseInt(b)>parseInt(d(this).val())?
a(!1,"Minimum allowed value: "+b,175):parseInt(d(this).val())?a(!0):a(!1,"The value entered is not a number.",200)},testMaxValue:function(a){var b=d(this).data("max");parseInt(b)<parseInt(d(this).val())?a(!1,"Maximum allowed value: "+b,175):parseInt(d(this).val())?a(!0):a(!1,"The value entered is not a number.",200)},maxChecked:function(a){var b=d(this).data("maxchecked");if(d(this).data("checkboxgroup")){var c=d(this).data("checkboxgroup");d("input[data-checkboxgroup="+c+"]:checked").length>b?a(!1,
"You cannot select more than "+b+" option(s).",250):a(!0)}else a(!0)},minChecked:function(a){var b=d(this).data("minchecked");if(d(this).data("checkboxgroup")){var c=d(this).data("checkboxgroup");d("input[data-checkboxgroup="+c+"]:checked").length<b?a(!1,"You must select at least "+b+" option(s).",250):a(!0)}else a(!0)},verifyMatch:function(a){var b=d("#"+d(this).data("matchfield"));d(this).val()===b.val()?a(!0):a(!1,"Passwords must match.",200)},email:function(a){a(l.regexTester(d(this),/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[A-Za-z]{2,4}$/),
"Not a valid email format.",200)},ssn:function(a){a(l.regexTester(d(this),/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/),"Not a valid social security number.",200)},uscurrency:function(a){a(l.regexTester(d(this),/^(\$|)([1-9]\d{0,2}(\,\d{3})*|([1-9]\d*))(\.\d{2})?$/),"Not a valid amount.",200)},phone:function(a){a(l.regexTester(d(this),/^\D?(\d{3})\D?\D?(\d{3})\D?(\d{4})$/),"Not a valid phone number.",200)},numeric:function(a){a(l.regexTester(d(this),/\/[0-9]|\.\//),"Only digits are allowed.",
200)},zip:function(a){a(l.regexTester(d(this),/^\d{5}$/),"Not a valid zip code.",200)},date:function(a){a(l.regexTester(d(this),/^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/),"Not a valid date.",200)},url:function(a){a(l.regexTester(d(this),
/^(http|https|ftp)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?\/?([a-zA-Z0-9\-\._\?\,\'/\\+&amp;%\$#\=~])*$/),"Not a valid url.",200)},password:function(a){a(l.regexTester(d(this),/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,40}$/),"Password must be at least 8 characters and include both upper and lower case letters and a number.",300)},regexTester:function(a,b){var c=b.test(a.val());return""===a.val()||c?!0:c}};return{setAdditionalEvents:y,validate:function(a){if(void 0!==a){a=d(a);try{var b=v(a,
null);k[b.time]={options:b};B(a,b)}catch(c){a.find(".validate").prop("disabled",!1)}}},validateForm:t,removeErrors:function(a){a=void 0===a?d("body"):d(a);a.find("input").each(function(a,c){d("[id^='"+d(c).data("vid")+"error']").remove();d("[id^='"+d(c).data("vid")+"InputGrp']").remove()});d("[id^='"+a.data("vid")+"']").each(function(a,c){c.remove()});a.find(".errorMessage").each(function(a,c){c.remove()});a.find(".invalid").each(function(a,c){d(c).removeClass("invalid")});a.find(".showGroupedErrors").each(function(a,
c){d(c).empty().removeClass("showGroupedErrors").addClass("hideGroupedErrors")})},validationRules:l}}(jQuery);
