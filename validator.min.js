var validator=function(c){function y(a){a&&a.constructor===Array&&c.each(a,function(a,d){c(document).on(d,"input",function(a){var b=c(a.currentTarget),f=b.parents(".inputValidate:first");!(b.hasClass("inputValidate")||f&&0<f.length)||b.data("validateon")!==d&&("input"!==d||void 0!=b.data("validateon"))||f.data("excludeinputs")&&-1!==f.data("excludeinputs").indexOf(a.currentTarget.id)||(a=v(b,a),f=[],f.push(z(c(b))),null===f[0]&&1===f.length)||(k[a.time]={options:a,inputArray:f},A(a,f),w(b))})})}function B(a,
b){a.data("vts",b.time);b.button.prop("disabled",!0);if(!1!==b.callBefore){var d=[window].concat(b.callBefore.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]});"function"===typeof d?d.call(a,t):t(!0,a,b)}else t(!0,a,b)}function t(a,b){var d=k[b.data("vts")].options;if(a){null!==d.groupErrors&&(c("#"+d.groupErrors).find(".errorSpan").remove(),c("#"+d.groupErrors).find("br").remove());for(var g=c(b).find("input, select"),e=[],f=0,h=g.length;f<h;f++){var m=z(c(g[f]));null!==
m&&(e=e.concat(m))}k[b.data("vts")].inputArray=e;A(d,e);w(b)}}function z(a){var b=a.data("validationrules")||"",d=a.data("customrules")||"",c={};""===a.data("required")&&(c.required="waiting");a.data("min")&&(c["validator.validationRules.testMinValue"]="waiting");a.data("max")&&(c["validator.validationRules.testMaxValue"]="waiting");a.data("matchfield")&&(c["validator.validationRules.verifyMatch"]="waiting");a.data("maxchecked")&&(c["validator.validationRules.maxChecked"]="waiting");a.data("minchecked")&&
(c["validator.validationRules.minChecked"]="waiting");for(var b=b.replace(/ /g,"").split(","),e=0;e<b.length;e++)""!==b[e]&&(c["validator.validationRules."+b[e]]="waiting");b=d.replace(/ /g,"").split(",");for(e=0;e<b.length;e++)""!==b[e]&&(c[b[e]]="waiting");return 0<Object.keys(c).length?{element:a,rules:c}:null}function A(a,b){for(var d=0,c=b.length;d<c;d++){var e=b[d].element,f=!1,h=performance.now().toString().split(".");E(e);n(e).removeClass("invalid");e.data("vts",a.time).data("vid",h[1]).attr("vts",
a.time);var h=b[d].rules,m;for(m in h)"required"===m?(tested="radio"===e[0].type||"checkbox"===e[0].type?l.requiredGroup(e):l.requiredInput(e),C(tested,e,a,m),tested.valid||(f=!0)):f?x(e,m,null):(h=[window].concat(m.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]}),"function"===typeof h?F(m,a.time,h,e):x(e,m,null))}}function F(a,b,d,c){var e=G(a,b,d,c,function(a){e.done.call(e,a)});e.customFunction.call(c[0],e.validate)}function C(a,b,d,g){if(!a.valid){var e=D(b);H(b,a,d,
g,e.width,e.height);if(d.group){if(0===c("#"+b.data("vid")+"InputGrp").length)a:switch(d=n(b),!1===b.hasClass("groupByInput")?b.parents(".formValidate:first").data("location")||"right":b.data("location")||"right"){case "right":d.after("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='hInputGroup alignInput'></div>");break a;case "left":d.before("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='hInputGroup alignInput'></div>");break a;case "top":d.before("<div id='"+
b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='vInputGroup'></div>");break a;case "bottom":d.after("<div id='"+b.data("vid")+"InputGrp' data-parentinput='"+b.data("vid")+"' class='vInputGroup'></div>")}d=c("#"+b.data("vid")+"error"+g);e="<span class='inputGrpErrorSpan'>"+d.html()+"</span></br>";c("#"+b.data("vid")+"InputGrp").append(e);d.remove()}else void 0!==d.groupErrors&&null!==d.groupErrors&&I(d,b,g)}x(b,g,a.valid)}function x(a,b,d){for(var c=a.data("vts"),e,f=0,h=k[c].inputArray.length;f<
h;f++)if(e=k[c].inputArray[f],a.data("vid")===e.element.data("vid")){e.rules[b]=d;break}}function J(a){try{c(this.element).data("vts")===this.timeStamp?(C(a,this.element,k[this.timeStamp].options,this.functionName),w(this.element)):delete k[this.timeStamp]}catch(b){k[this.timeStamp].options.button&&k[this.timeStamp].options.button.prop("disabled",!1)}}function w(a){var b=a.data("vts");if(k[b]){k[b].options.form||c(k[b].options.input);a=0;for(var d=k[b].inputArray,b=k[b].options,g=0,e=d.length;g<e;g++)for(var f in d[g].rules){if("waiting"===
d[g].rules[f])return;!1===d[g].rules[f]&&a++}delete k[b.time];b.button&&b.button.prop("disabled",!1);b.groupErrors&&b.form.hasClass("highlightErrors")&&c.each(d,function(a,b){c.each(b.rules,function(a,d){!1===d&&(c(b.element).on("focus",function(){c("[id='formGrp"+b.element.data("vid")+a+"']").addClass("groupHighlight")}),c(b.element).on("blur",function(){c("[id='formGrp"+b.element.data("vid")+a+"']").removeClass("groupHighlight")}))})});c(document).trigger("validated",[{type:void 0===b.form?"input validation":
"form validation",element:void 0!==b.form?b.form[0].id:b.input,succeeded:0===a,event:b.event}]);0===a&&null!==b.success?(f=[window].concat(b.success.split(".")).reduce(function(a,b){return"function"===typeof a?a()[b]:a[b]}),"function"===typeof f&&f.call(b.form?b.form[0]:b.input[0])):0===a&&null!==b.event&&null!==b.event.currentTarget&&void 0===b.input?(b.event.preventDefault(),b.form[0].submit()):0!==a&&null!==b.event&&null!==b.event.currentTarget&&b.event.preventDefault()}}function I(a,b,d){c("#"+
b.data("vid")+"error"+d).each(function(e,f){var g=c(b).data("errorprefix");void 0!==g&&c(f).html(g+": "+c(f).html());g="<span class='errorSpan' id='formGrp"+b.data("vid")+d+"' data-parentinput='"+b.data("vid")+"'>"+c(f).html()+"</span>";K(a,b.data("vid"),g,d);c(f).remove()});var g=c("#"+a.groupErrors);g.hasClass("showGroupedErrors")||g.removeClass("hideGroupedErrors").addClass("showGroupedErrors")}function K(a,b,d,g){var e=c("#"+a.groupErrors).find("[id^='formGrp"+b+"']");if(0<e.length)c(d).insertBefore(e[0]),
c("</br>").insertAfter(c("#formGrp"+b+g));else{var e=a.form.find("input"),f=e.filter(function(){return c(this).data("vid")===b?c(this):!1}),f=e.index(f);if(f<e.length-1)for(f+=1;f<e.length;f++){var h=c("#"+a.groupErrors).children("[data-parentinput='"+c(e[f]).data("vid")+"']");if(0<h.length){c(d).insertBefore(h);c("</br>").insertAfter(c("#formGrp"+b+g));return}}c("#"+a.groupErrors).append(d).append("</br>")}}function H(a,b,d,g,e,f){L(a,b,d,g,e,f);var h=c("#"+a.data("vid")+"error"+g);0<a.prevUntil("input").filter(".helptext:first").length&&
a.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");d.display?M(d,a,h,e,f):d.display||null!==d.modalId?d.display||null===d.modalId||N(d.modalId,a,e,f,h):c(window).scroll(function(){q(a,e,f,h)})}function L(a,b,d,g,e,f){var h=n(a);h.addClass("invalid");g=a.data("vid")+"error"+g;1>c("#"+g).length&&(h.parent().append("<div id='"+g+"' data-parentinput='"+a.data("vid")+"'></div>"),h=c("#"+g),h.addClass("errorMessage"),h.html(void 0===b.message?"Validation Error":
b.message).css("width",void 0===b.width?"":b.width),q(a,e,f,h),d.display?h.addClass("hideMessage").removeClass("showMessage"):h.addClass("showMessage").removeClass("hideMessage"))}function u(a,b,d,g,e){var f,h,k=void 0===b.data("location")?"right":b.data("location");f=parseInt(b.data("offsetwidth"))||0;h=parseInt(b.data("offsetheight"))||0;switch(k){case "right":return[a.left+n(b).width()+d+f+8-c(window).scrollLeft(),a.top-c(window).scrollTop()-h];case "left":return[a.left-e.width()-d-f-8-c(window).scrollLeft(),
a.top-c(window).scrollTop()-h];case "top":return[a.left+f-c(window).scrollLeft(),a.top-c(window).scrollTop()-5-e.height()-g-h];case "bottom":return[a.left+f-c(window).scrollLeft(),a.top-c(window).scrollTop()+n(b)[0].clientHeight+8+g+h]}}function E(a){c("[id^='"+a.data("vid")+"']").each(function(a,d){c(d).remove()})}function q(a,b,d,c){a=u(n(a).offset(),a,b,d,c);c.addClass("showMessage").removeClass("hideMessage").css("top",a[1]).css("left",a[0])}function M(a,b,d,c,e){var f=n(b);f.bind("mouseover",
function(){null!==a.modalId?r(a.modalId,b,c,e,d)&&q(b,c,e,d):q(b,c,e,d)});f.bind("mouseout",function(){d.addClass("hideMessage").removeClass("showMessage")})}function r(a,b,d,g,e){b=u(n(b).offset(),b,d,g,e);g=c("#"+a);var f=g.offset();a=f.top-c(window).scrollTop();d=a+g.height();f=f.left-c(window).scrollLeft();g=f+g.width();return a>b[1]||d<b[1]||f>b[0]||g<b[0]+e.width()?!1:!0}function N(a,b,d,g,e){r(a,b,d,g,e)||e.addClass("hideMessage").removeClass("showMessage");c("#"+a).on("scroll",function(){r(a,
b,d,g,e)?(q(b,d,g,e),e.removeClass("hideMessage").addClass("showMessage")):e.addClass("hideMessage").removeClass("showMessage")});c(window).scroll(function(){r(a,b,d,g,e)?(q(b,d,g,e),e.removeClass("hideMessage").addClass("showMessage")):e.addClass("hideMessage").removeClass("showMessage")})}function D(a){var b=0,d=0;c("[id^='"+a.data("vid")+"error']").each(function(a,e){b+=c(e).width()+5;d+=c(e).height()+5});return{width:b,height:d}}function n(a){var b=void 0===a.data("displayon")?null:a.data("displayon"),
d,g;if(null!==b){d=b.split(",");b=d[0];g=d[1];if(1===c(b).length)return c(b);var e="up"===d[1]?":last":":first";if(0===("up"===g?a.prevAll(b+":first"):a.nextAll(b+":first")).length)for(d=a.parent();0!==d.length;){if(d.hasClass(b.substring(1,b.length)))return d;for(var f="up"===g?d.prev():d.next();0!==f.length;){if(f.hasClass(b.substring(1,b.length)))return f;var h=f.find(b+e);if(0!==h.length)return h;f="up"===g?f.prev():f.next()}d=d.parent()}else return"up"===d[1]?a.prevAll(b+":first"):a.nextAll(b+
":first")}return a}function O(a,b){var d=a.prevUntil("input").filter(".helptext:first"),g=n(a).offset(),e=D(a);d.addClass("showMessage").removeClass("hideMessage");var f=u(g,a,0,0,d);d.css("top",f[1]).css("left",f[0]);a.data("htid",(new Date).getTime());null!==b&&(c(document).on("helpTextModalScroll"+a.data("htid"),function(){var c=e.width,f=e.height;!r(b,a,c,f,d)||a.hasClass("invalid")?d.addClass("hideMessage").removeClass("showMessage"):(d.addClass("showMessage").removeClass("hideMessage"),q(a,
c,f,d))}),c("#"+b).on("scroll",function(){c(document).trigger("helpTextModalScroll"+a.data("htid"),[{}])}));c(document).on("helpTextScroll"+a.data("htid"),function(){var b=u(g,a,e.width,e.height,d);d.css("top",b[1]).css("left",b[0])});c(window).on("scroll",function(){c(document).trigger("helpTextScroll"+a.data("htid"),[{}])})}function P(a,b,d){c.each(b.split(","),function(b,c){var f=p[c];if("function"===typeof f&&!f.call(a,d))return d.preventDefault(),!1})}function v(a,b){var d={display:a.hasClass("hover"),
success:a.data("formaction")||a.data("inputaction")||null,modalId:a.data("modalid")||null,group:!1===a.hasClass("groupByInput")?a.parents(".formValidate:first").hasClass("groupByInput"):a.hasClass("groupByInput"),time:(new Date).getTime(),event:b};"INPUT"===a[0].tagName?d.input=a:(d.form=a,d.groupErrors=a.data("grouperrors")||null,d.callBefore=a.data("beforevalidate")||!1,d.button=a.find(".validate")||b.currentTarget);return d}function G(a,b,d,c,e){return{done:J,customFunction:d,functionName:a,element:c,
validate:e,timeStamp:b}}var k={};c(document).on("click","input, button",function(a){var b=c(a.currentTarget),d=b.parents(".formValidate:first");0<d.length&&b.hasClass("validate")&&(a=v(d,a),k[a.time]={options:a},B(d,a))});c(document).on("keypress","input",function(a){var b=c(a.currentTarget);void 0!=b.data("inputtype")&&P(b,b.data("inputtype"),a)});c(document).on("focus","input",function(a){var b=c(a.currentTarget);if(!b.hasClass("invalid")&&0<b.prevUntil("input").filter(".helptext:first").length&&
1>c("[id^='"+b.data("vid")+"error']").length&&1>c("#"+b[0].id+"InputGrp").length){var d=b.parents(".formValidate:first").data("modalId")||b.parents(".inputValidate:first").data("modalId")||b.data("modalId")||null;O(b,d);b.one("blur",function(a){b.prevUntil("input").filter(".helptext:first").addClass("hideMessage").removeClass("showMessage");null!==d&&c(document).off("helpTextModalScroll"+b.data("htid"));c(document).off("helpTextScroll"+b.data("htid"))})}});y(["input"]);var p={inputTypeTester:function(a,
b){for(var d=b.charCode?b.charCode:b.keyCode,g=0,e=a.length;g<e;g++)if(c.isArray(a[g])){if(d>a[g][0]&&d<a[g][1])return!0}else if(d===a[g])return!0;return!1},numeric:function(a){return p.inputTypeTester([8,[43,47],[47,58]],a)},integer:function(a){return p.inputTypeTester([8,45,[47,58]],a)},positiveInt:function(a){return p.inputTypeTester([8,[47,58]],a)},nonNumeric:function(a){return p.inputTypeTester([[-1,48],[57,128]],a)},alphaNumeric:function(a){return p.inputTypeTester([8,[47,58],[64,91],[96,123]],
a)},nonAlphaNumeric:function(a){return p.inputTypeTester([[-1,48],[57,65],[90,97],[122,128]],a)},shortDate:function(a){return p.inputTypeTester([8,[44,58]],a)},longDate:function(a){return p.inputTypeTester([8,32,44,46,[47,58],[64,91],[96,123]],a)}},l={requiredInput:function(a){var b=/^\s*$/.test(a.val());return 1>a.val().length||b||""===a.val()?{valid:!1,message:"Required field.",width:100}:{valid:!0}},requiredGroup:function(a){return a.attr("name")?(a=a.attr("name"),void 0===c("input[name="+a+"]:checked").val()?
{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):a.data("checkboxgroup")?(a=a.data("checkboxgroup"),1>c("input[data-checkboxgroup="+a+"]:checked").length?{valid:!1,message:"You must select an option.",width:175}:{valid:!0}):{valid:!1,message:"This input has no identifying name."}},testMinValue:function(a){var b=c(this).data("min");parseInt(b)>parseInt(c(this).val())?a({valid:!1,message:"Minimum allowed value: "+b,width:175}):parseInt(c(this).val())?a({valid:!0}):a({valid:!1,message:"The value entered is not a number.",
width:200})},testMaxValue:function(a){var b=c(this).data("max");parseInt(b)<parseInt(c(this).val())?a({valid:!1,message:"Maximum allowed value: "+b,width:175}):parseInt(c(this).val())?a({valid:!0}):a({valid:!1,message:"The value entered is not a number.",width:200})},maxChecked:function(a){var b=c(this).data("maxchecked");if(c(this).data("checkboxgroup")){var d=c(this).data("checkboxgroup");c("input[data-checkboxgroup="+d+"]:checked").length>b?a({valid:!1,message:"You cannot select more than "+b+
" option(s).",width:250}):a({valid:!0})}else a({valid:!0})},minChecked:function(a){var b=c(this).data("minchecked");if(c(this).data("checkboxgroup")){var d=c(this).data("checkboxgroup");c("input[data-checkboxgroup="+d+"]:checked").length<b?a({valid:!1,message:"You must select at least "+b+" option(s).",width:250}):a({valid:!0})}else a({valid:!0})},verifyMatch:function(a){var b=c("#"+c(this).data("matchfield"));c(this).val()===b.val()?a({valid:!0}):a({valid:!1,message:"Passwords must match.",width:200})},
email:function(a){a(l.regexTester(c(this),/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[A-Za-z]{2,4}$/,"Not a valid email format.",200))},ssn:function(a){a(l.regexTester(c(this),/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/,"Not a valid social security number.",200))},uscurrency:function(a){a(l.regexTester(c(this),/^(\$|)([1-9]\d{0,2}(\,\d{3})*|([1-9]\d*))(\.\d{2})?$/,"Not a valid amount.",200))},phone:function(a){a(l.regexTester(c(this),/^\D?(\d{3})\D?\D?(\d{3})\D?(\d{4})$/,"Not a valid phone number.",
200))},numeric:function(a){a(l.regexTester(c(this),/\/[0-9]|\.\//,"Only digits are allowed.",200))},zip:function(a){a(l.regexTester(c(this),/^\d{5}$/,"Not a valid zip code.",200))},date:function(a){a(l.regexTester(c(this),/^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/,
"Not a valid date.",200))},url:function(a){a(l.regexTester(c(this),/^(http|https|ftp)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?\/?([a-zA-Z0-9\-\._\?\,\'/\\+&amp;%\$#\=~])*$/,"Not a valid url.",200))},password:function(a){a(l.regexTester(c(this),/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,40}$/,"Password must be at least 8 characters and include both upper and lower case letters and a number.",300))},regexTester:function(a,b,d,c){b=b.test(a.val());return""===a.val()||b?{valid:!0}:{valid:b,message:d,
width:c}}};return{setAdditionalEvents:y,validate:function(a){if(void 0!==a){a=c(a);try{var b=v(a,null);k[b.time]={options:b};B(a,b)}catch(d){a.find(".validate").prop("disabled",!1)}}},validateForm:t,removeErrors:function(a){a=void 0===a?c("body"):c(a);a.find("input").each(function(a,d){c("[id^='"+c(d).data("vid")+"error']").remove();c("[id^='"+c(d).data("vid")+"InputGrp']").remove()});c("[id^='"+a.data("vid")+"']").each(function(a,c){c.remove()});a.find(".errorMessage").each(function(a,c){c.remove()});
a.find(".invalid").each(function(a,d){c(d).removeClass("invalid")});a.find(".showGroupedErrors").each(function(a,d){c(d).empty().removeClass("showGroupedErrors").addClass("hideGroupedErrors")})},validationRules:l}}(jQuery);
